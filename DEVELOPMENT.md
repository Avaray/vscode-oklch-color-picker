# Development Guide

> Warning. This file was generated by AI. Not sure if it's accurate. I need to
> check it.

This guide covers how to develop and contribute to the OKLCH Color Picker
extension using [Bun](https://bun.sh).

## Prerequisites

- [Bun](https://bun.sh) v2.0 or higher
- [Visual Studio Code](https://code.visualstudio.com/) v1.50.0 or higher
- [Git](https://git-scm.com/)

## Setup

### 1. Clone the repository

```bash
git clone https://github.com/Avaray/vscode-oklch-color-picker.git
cd vscode-oklch-color-picker
```

### 2. Install dependencies

```bash
bun install
```

### 3. Compile the extension

```bash
bun run compile
```

## Development Workflow

### Run in watch mode

This automatically recompiles when you save changes:

```bash
bun run watch
```

### Test the extension

1. Press `F5` in VS Code to open a new Extension Development Host window
2. Open a file with `oklch()` or `oklab()` colors
3. Test the color picker functionality
4. Make changes to the code
5. Press `Ctrl+R` (or `Cmd+R` on Mac) in the Extension Development Host to
   reload

## Code Quality

### Run linter

```bash
bun run lint
```

### Fix linting issues automatically

```bash
bunx eslint src --fix
```

## Building

### Package the extension

Create a `.vsix` file for distribution:

```bash
bun run package
```

This creates a `oklch-color-picker-*.vsix` file in the root directory.

### Install locally for testing

```bash
code --install-extension oklch-color-picker-*.vsix
```

## Project Structure

```text
.
├── src/
│   ├── extension.ts        # Main extension code
│   └── declarations.d.ts   # Type declarations
├── out/                    # Compiled JavaScript (generated)
├── .github/
│   └── workflows/
│       └── release.yml     # Automated release workflow
├── package.json            # Extension manifest
├── tsconfig.json           # TypeScript configuration
└── README.md               # User documentation
```

## Making Changes

### 1. Create a feature branch

```bash
git checkout -b feature/your-feature-name
```

### 2. Make your changes

Edit files in the `src/` directory.

### 3. Test your changes

- Run `bun run compile`
- Press `F5` to test in Extension Development Host
- Verify color picker works with both `oklch()` and `oklab()`

### 4. Commit and push

```bash
git add .
git commit -m "feat: your feature description"
git push origin feature/your-feature-name
```

### 5. Create a Pull Request

Open a PR on GitHub describing your changes.

## Releasing

Releases are automated via GitHub Actions when the version in `package.json`
changes.

### Manual version bump

```bash
# Update version in package.json manually, then:
git add package.json
git commit -m "chore: bump version to 1.1.0"
git push origin main
```

The GitHub Action will automatically:

1. Compile the extension
2. Package it as `.vsix`
3. Create a GitHub release
4. Attach the `.vsix` file

## Debugging

### Enable extension logs

1. Open Developer Tools: `Help → Toggle Developer Tools`
2. Go to the Console tab
3. Look for extension-related logs

### Common issues

**Extension not activating:**

- Check if `activationEvents` in `package.json` is configured
- Verify the file language is supported

**Colors not detected:**

- Check regex pattern in `provideDocumentColors`
- Ensure culori can parse the color format

**TypeScript errors:**

- Run `bun install` to ensure `@types/vscode` is installed
- Restart TypeScript server: `Ctrl+Shift+P` → "TypeScript: Restart TS Server"

## Resources

- [VS Code Extension API](https://code.visualstudio.com/api)
- [Bun Documentation](https://bun.sh/docs)
- [OKLCH Color Space](https://oklch.com/)
- [Culori Documentation](https://culorijs.org/)

## Contributing

We welcome contributions! Please follow these guidelines:

1. Follow the existing code style
2. Write clear commit messages
3. Add tests for new features
4. Update documentation as needed
5. Be respectful and constructive in discussions

## License

This project is licensed under the MIT License - see the LICENSE file for
details.

## Support

If you encounter issues or have questions:

- Open an issue on
  [GitHub](https://github.com/Avaray/vscode-oklch-color-picker/issues)
- Check existing issues for solutions
- Provide detailed information about your environment and the problem
